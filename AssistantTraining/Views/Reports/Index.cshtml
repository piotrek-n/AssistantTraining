@model AssistantTraining.ViewModel.ReportsIndexData
@{
    ViewBag.Title = "Home Page";
}
@section styles {
    @Styles.Render("~/Content/gridmvc")
}

<div class="form-horizontal">
    <hr />
    <div class="form-group">
        @Html.Label("Raporty", htmlAttributes: new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.DropDownListFor(x => x.SelectedId, Model.Items, new { @class = "form-control", @style = "display:inline-block;" })
            <a href="" id="ReportLink" class="btn btn-default">
                Export to Excel
                <span class="glyphicon" aria-hidden="true"></span>
            </a>
        </div>
    </div>
</div>

<div id="example-container">
    <table cellpadding="0" cellspacing="0" border="0"
           class="table table-striped table-bordered center-table" id="example"></table>
</div>

@section scripts {
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/bundles/gridmvc")
    @Scripts.Render("~/bundles/typeahead")
    @*<script src="~/Scripts/DataTables/jquery.dataTables.js"></script>*@
    @*<script type="text/javascript" charset="utf8" src="http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.4/jquery.dataTables.min.js"></script>*@
    @Scripts.Render("~/bundles/application/reports")

}

<script type="text/javascript">
    jQuery(document).ready(function () {

        $("#SelectedId").change(function () {
            var url = '@Url.Action("GetExcelFile", "Reports")';
            url += '/' + $(this).val();
            var link = document.getElementById("ReportLink");
            link.setAttribute("href", url);
        });

        });
</script>